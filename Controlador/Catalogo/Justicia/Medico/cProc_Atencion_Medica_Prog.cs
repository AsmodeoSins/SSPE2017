using SSP.Servidor;
using SSP.Modelo;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace SSP.Controlador.Catalogo.Justicia
{
    public class cProc_Atencion_Medica_Prog:EntityManagerServer<PROC_ATENCION_MEDICA_PROG>
    {
        public IQueryable<PROC_ATENCION_MEDICA_PROG> Obtener_Historial_Hospitalizacion(decimal id_hospitalizacion, short id_centro_ubi)
        {
            try
            {
                if (!Context.PROC_ATENCION_MEDICA_PROG.Any(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.HOSPITALIZACION.Any(a => a.ID_HOSPITA == id_hospitalizacion && w.ID_CENTRO_UBI == id_centro_ubi)))
                    if (!Context.PROC_ATENCION_MEDICA_PROG.Any(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.ATENCION_MEDICA.ID_HOSPITA == id_hospitalizacion && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.ATENCION_MEDICA.ID_CENTRO_UBI == id_centro_ubi))
                        if (!Context.PROC_ATENCION_MEDICA_PROG.Any(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a => a.ESPECIALISTA_CITA.Any(a2 => a2.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.HOSPITALIZACION.Any(a3 => a3.ID_HOSPITA == id_hospitalizacion && a3.ID_CENTRO_UBI == id_centro_ubi)))))
                            if (!Context.PROC_ATENCION_MEDICA_PROG.Any(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a2 => a2.ESPECIALISTA_CITA.Any(a => a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_HOSPITA == id_hospitalizacion && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_CENTRO_UBI == id_centro_ubi && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.ID_ESTATUS_CAN == "A" && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.ID_INTER == 1))))
                                return null;
                            else
                                //PROCEDIMIENTOS REALIZADOS DE ESPECIALIDAD DE NOTA DE EVOLUCION
                                return Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a2 => a2.ESPECIALISTA_CITA.Any(a => a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_HOSPITA == id_hospitalizacion && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_CENTRO_UBI == id_centro_ubi && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.ID_ESTATUS_CAN == "A" && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.ID_INTER == 1)));
                        else
                            if (!Context.PROC_ATENCION_MEDICA_PROG.Any(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a => a.ESPECIALISTA_CITA.Any(a2 => a2.ATENCION_CITA.ATENCION_MEDICA.ID_HOSPITA == id_hospitalizacion && a2.ATENCION_CITA.ATENCION_MEDICA.ID_CENTRO_UBI == id_centro_ubi))))
                                //PROCEDIMIENTOS REALIZADOS DE ESPECIALIDAD DE NOTA DE INGRESO
                                return Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a => a.ESPECIALISTA_CITA.Any(a2 => a2.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.HOSPITALIZACION.Any(a3 => a3.ID_HOSPITA == id_hospitalizacion && a3.ID_CENTRO_UBI == id_centro_ubi))));
                            else
                                //PROCEDIMIENTOS REALIZADOS DE ESPECIALIDAD DE NOTA DE EVOLUCION Y DE ESPECIALIDAD DE NOTA DE INGRESO
                                return Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a => a.ESPECIALISTA_CITA.Any(a2 => a2.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.HOSPITALIZACION.Any(a3 => a3.ID_HOSPITA == id_hospitalizacion && a3.ID_CENTRO_UBI == id_centro_ubi))))
                                    .Union(Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a2 => a2.ESPECIALISTA_CITA.Any(a => a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_HOSPITA == id_hospitalizacion && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_CENTRO_UBI == id_centro_ubi && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.ID_ESTATUS_CAN == "A" && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.ID_INTER == 1))));
                    else
                        if (!Context.PROC_ATENCION_MEDICA_PROG.Any(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a => a.ESPECIALISTA_CITA.Any(a2 => a2.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.HOSPITALIZACION.Any(a3 => a3.ID_HOSPITA == id_hospitalizacion && a3.ID_CENTRO_UBI == id_centro_ubi)))))
                            if (!Context.PROC_ATENCION_MEDICA_PROG.Any(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a2 => a2.ESPECIALISTA_CITA.Any(a => a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_HOSPITA == id_hospitalizacion && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_CENTRO_UBI == id_centro_ubi && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.ID_ESTATUS_CAN == "A" && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.ID_INTER == 1))))
                                //PROCEDIMIENTOS REALIZADOS DE NOTA DE EVOLUCION
                                return Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.ATENCION_MEDICA.ID_HOSPITA == id_hospitalizacion && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.ATENCION_MEDICA.ID_CENTRO_UBI == id_centro_ubi);
                            else
                                //PROCEDIMIENTOS REALIZADOS DE NOTA DE EVOLUCION,RECETA MEDICA DE ESPECIALIDAD DE NOTA DE EVOLUCION
                                return Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.ATENCION_MEDICA.ID_HOSPITA == id_hospitalizacion && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.ATENCION_MEDICA.ID_CENTRO_UBI == id_centro_ubi)
                                    .Union(Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a2 => a2.ESPECIALISTA_CITA.Any(a => a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_HOSPITA == id_hospitalizacion && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_CENTRO_UBI == id_centro_ubi && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.ID_ESTATUS_CAN == "A" && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.ID_INTER == 1))));
                        else
                            if (!Context.PROC_ATENCION_MEDICA_PROG.Any(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a2 => a2.ESPECIALISTA_CITA.Any(a => a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_HOSPITA == id_hospitalizacion && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_CENTRO_UBI == id_centro_ubi && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.ID_ESTATUS_CAN == "A" && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.ID_INTER == 1))))
                                //PROCEDIMIENTOS REALIZADOS DE NOTA DE EVOLUCION,RECETA MEDICA DE ESPECIALIDAD DE NOTA DE INGRESO
                                return Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.ATENCION_MEDICA.ID_HOSPITA == id_hospitalizacion && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.ATENCION_MEDICA.ID_CENTRO_UBI == id_centro_ubi)
                                    .Union(Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a => a.ESPECIALISTA_CITA.Any(a2 => a2.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.HOSPITALIZACION.Any(a3 => a3.ID_HOSPITA == id_hospitalizacion && a3.ID_CENTRO_UBI == id_centro_ubi)))));
                            else
                                //PROCEDIMIENTOS REALIZADOS DE NOTA DE EVOLUCION,RECETA MEDICA DE ESPECIALIDAD DE NOTA DE EVOLUCION Y DE ESPECIALIDAD DE NOTA DE INGRESO
                                return Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.ATENCION_MEDICA.ID_HOSPITA == id_hospitalizacion && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.ATENCION_MEDICA.ID_CENTRO_UBI == id_centro_ubi)
                                    .Union(Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a => a.ESPECIALISTA_CITA.Any(a2 => a2.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.HOSPITALIZACION.Any(a3 => a3.ID_HOSPITA == id_hospitalizacion && a3.ID_CENTRO_UBI == id_centro_ubi)))))
                                    .Union(Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a2 => a2.ESPECIALISTA_CITA.Any(a => a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_HOSPITA == id_hospitalizacion && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_CENTRO_UBI == id_centro_ubi && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.ID_ESTATUS_CAN == "A" && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.ID_INTER == 1))));
                else
                    if (!Context.PROC_ATENCION_MEDICA_PROG.Any(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.ATENCION_MEDICA.ID_HOSPITA == id_hospitalizacion && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.ATENCION_MEDICA.ID_CENTRO_UBI == id_centro_ubi))
                        if (!Context.PROC_ATENCION_MEDICA_PROG.Any(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a => a.ESPECIALISTA_CITA.Any(a2 => a2.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.HOSPITALIZACION.Any(a3 => a3.ID_HOSPITA == id_hospitalizacion && a3.ID_CENTRO_UBI == id_centro_ubi)))))
                            if (!Context.PROC_ATENCION_MEDICA_PROG.Any(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a2 => a2.ESPECIALISTA_CITA.Any(a => a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_HOSPITA == id_hospitalizacion && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_CENTRO_UBI == id_centro_ubi && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.ID_ESTATUS_CAN == "A" && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.ID_INTER == 1))))
                                //PROCEDIMIENTOS REALIZADOS DE NOTA DE INGRESO
                                return Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.HOSPITALIZACION.Any(a => a.ID_HOSPITA == id_hospitalizacion && w.ID_CENTRO_UBI == id_centro_ubi));
                            else
                                //PROCEDIMIENTOS REALIZADOS DE NOTA DE INGRESO, PROCEDIMIENTOS REALIZADOS DE ESPECIALIDAD DE NOTA DE EVOLUCION
                                return Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.HOSPITALIZACION.Any(a => a.ID_HOSPITA == id_hospitalizacion && w.ID_CENTRO_UBI == id_centro_ubi))
                                    .Union(Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a2 => a2.ESPECIALISTA_CITA.Any(a => a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_HOSPITA == id_hospitalizacion && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_CENTRO_UBI == id_centro_ubi && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.ID_ESTATUS_CAN == "A" && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.ID_INTER == 1))));
                        else
                            if (!Context.PROC_ATENCION_MEDICA_PROG.Any(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a2 => a2.ESPECIALISTA_CITA.Any(a => a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_HOSPITA == id_hospitalizacion && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_CENTRO_UBI == id_centro_ubi && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.ID_ESTATUS_CAN == "A" && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.ID_INTER == 1))))
                                //PROCEDIMIENTOS REALIZADOS DE NOTA DE INGRESO, PROCEDIMIENTOS REALIZADOS DE ESPECIALIDAD DE NOTA DE INGRESO
                                return Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.HOSPITALIZACION.Any(a => a.ID_HOSPITA == id_hospitalizacion && w.ID_CENTRO_UBI == id_centro_ubi))
                                    .Union(Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a => a.ESPECIALISTA_CITA.Any(a2 => a2.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.HOSPITALIZACION.Any(a3 => a3.ID_HOSPITA == id_hospitalizacion && a3.ID_CENTRO_UBI == id_centro_ubi)))));
                            else
                                //PROCEDIMIENTOS REALIZADOS DE NOTA DE INGRESO, PROCEDIMIENTOS REALIZADOS DE ESPECIALIDAD DE NOTA DE EVOLUCION Y DE ESPECIALIDAD DE NOTA DE INGRESO
                                return Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.HOSPITALIZACION.Any(a => a.ID_HOSPITA == id_hospitalizacion && w.ID_CENTRO_UBI == id_centro_ubi))
                                    .Union(Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a => a.ESPECIALISTA_CITA.Any(a2 => a2.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.HOSPITALIZACION.Any(a3 => a3.ID_HOSPITA == id_hospitalizacion && a3.ID_CENTRO_UBI == id_centro_ubi)))))
                                    .Union(Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a2 => a2.ESPECIALISTA_CITA.Any(a => a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_HOSPITA == id_hospitalizacion && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_CENTRO_UBI == id_centro_ubi && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.ID_ESTATUS_CAN == "A" && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.ID_INTER == 1))));
                    else
                        if (!Context.PROC_ATENCION_MEDICA_PROG.Any(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a => a.ESPECIALISTA_CITA.Any(a2 => a2.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.HOSPITALIZACION.Any(a3 => a3.ID_HOSPITA == id_hospitalizacion && a3.ID_CENTRO_UBI == id_centro_ubi)))))
                            if (!Context.PROC_ATENCION_MEDICA_PROG.Any(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a2 => a2.ESPECIALISTA_CITA.Any(a => a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_HOSPITA == id_hospitalizacion && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_CENTRO_UBI == id_centro_ubi && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.ID_ESTATUS_CAN == "A" && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.ID_INTER == 1))))
                                //PROCEDIMIENTOS REALIZADOS DE NOTA DE INGRESO, PROCEDIMIENTOS REALIZADOS DE NOTA DE EVOLUCION
                                return Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.HOSPITALIZACION.Any(a => a.ID_HOSPITA == id_hospitalizacion && w.ID_CENTRO_UBI == id_centro_ubi))
                                    .Union(Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.ATENCION_MEDICA.ID_HOSPITA == id_hospitalizacion && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.ATENCION_MEDICA.ID_CENTRO_UBI == id_centro_ubi));
                            else
                                //PROCEDIMIENTOS REALIZADOS DE NOTA DE INGRESO, PROCEDIMIENTOS REALIZADOS DE NOTA DE EVOLUCION,PROCEDIMIENTOS REALIZADOS DE ESPECIALIDAD DE NOTA DE EVOLUCION
                                return Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.HOSPITALIZACION.Any(a => a.ID_HOSPITA == id_hospitalizacion && w.ID_CENTRO_UBI == id_centro_ubi))
                                    .Union(Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.ATENCION_MEDICA.ID_HOSPITA == id_hospitalizacion && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.ATENCION_MEDICA.ID_CENTRO_UBI == id_centro_ubi))
                                    .Union(Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a2 => a2.ESPECIALISTA_CITA.Any(a => a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_HOSPITA == id_hospitalizacion && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_CENTRO_UBI == id_centro_ubi && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.ID_ESTATUS_CAN == "A" && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.ID_INTER == 1))));
                        else
                            if (!Context.PROC_ATENCION_MEDICA_PROG.Any(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a2 => a2.ESPECIALISTA_CITA.Any(a => a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_HOSPITA == id_hospitalizacion && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_CENTRO_UBI == id_centro_ubi && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.ID_ESTATUS_CAN == "A" && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.ID_INTER == 1))))
                                //PROCEDIMIENTOS REALIZADOS DE NOTA DE INGRESO, PROCEDIMIENTOS REALIZADOS DE NOTA DE EVOLUCION,PROCEDIMIENTOS REALIZADOS DE ESPECIALIDAD DE NOTA DE INGRESO
                                return Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.HOSPITALIZACION.Any(a => a.ID_HOSPITA == id_hospitalizacion && w.ID_CENTRO_UBI == id_centro_ubi))
                                    .Union(Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.ATENCION_MEDICA.ID_HOSPITA == id_hospitalizacion && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.ATENCION_MEDICA.ID_CENTRO_UBI == id_centro_ubi))
                                    .Union(Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a => a.ESPECIALISTA_CITA.Any(a2 => a2.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.HOSPITALIZACION.Any(a3 => a3.ID_HOSPITA == id_hospitalizacion && a3.ID_CENTRO_UBI == id_centro_ubi)))));
                            else
                                //PROCEDIMIENTOS REALIZADOS DE NOTA DE INGRESO, PROCEDIMIENTOS REALIZADOS DE NOTA DE EVOLUCION,PROCEDIMIENTOS REALIZADOS DE ESPECIALIDAD DE NOTA DE EVOLUCION Y DE ESPECIALIDAD DE NOTA DE INGRESO
                                return Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.HOSPITALIZACION.Any(a => a.ID_HOSPITA == id_hospitalizacion && w.ID_CENTRO_UBI == id_centro_ubi))
                                    .Union(Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.ATENCION_MEDICA.ID_HOSPITA == id_hospitalizacion && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.ATENCION_MEDICA.ID_CENTRO_UBI == id_centro_ubi))
                                    .Union(Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a => a.ESPECIALISTA_CITA.Any(a2 => a2.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.HOSPITALIZACION.Any(a3 => a3.ID_HOSPITA == id_hospitalizacion && a3.ID_CENTRO_UBI == id_centro_ubi)))))
                                    .Union(Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a2 => a2.ESPECIALISTA_CITA.Any(a => a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_HOSPITA == id_hospitalizacion && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_CENTRO_UBI == id_centro_ubi && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.ID_ESTATUS_CAN == "A" && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.ID_INTER == 1))));

                
                //queries
                //Procedimientos medicos de la nota de ingreso
                //Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.HOSPITALIZACION.Any(a => a.ID_HOSPITA == id_hospitalizacion && w.ID_CENTRO_UBI == id_centro_ubi))
                //Procedimientos medicos de las nota de evolucion
                //Context.PROC_ATENCION_MEDICA_PROG.Where(w => w.ESTATUS == "S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.ATENCION_MEDICA.ID_HOSPITA==id_hospitalizacion && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.NOTA_MEDICA.ATENCION_MEDICA.ID_CENTRO_UBI==id_centro_ubi)
                //Procedimientos medicos de especialidades que originan de la nota media de ingreso
                //Context.PROC_ATENCION_MEDICA_PROG.Where(w =>w.ESTATUS=="S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a => a.ESPECIALISTA_CITA.Any(a2 => a2.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.HOSPITALIZACION.Any(a3 => a3.ID_HOSPITA == id_hospitalizacion && a3.ID_CENTRO_UBI == id_centro_ubi))))
                //Procedimientos medicos de especialidades que originan de las notas medicas de evolucion
                //Context.PROC_ATENCION_MEDICA_PROG.Where(w =>w.ESTATUS=="S" && w.PROC_ATENCION_MEDICA.ATENCION_MEDICA.ATENCION_CITA.Any(a2=>a2.ESPECIALISTA_CITA.Any(a => a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_HOSPITA == id_hospitalizacion && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.NOTA_MEDICA.ATENCION_MEDICA.ID_CENTRO_UBI == id_centro_ubi && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.CANALIZACION.ID_ESTATUS_CAN == "A" && a.SOL_INTERCONSULTA_INTERNA.INTERCONSULTA_SOLICITUD.ID_INTER == 1)))
            }
            catch (Exception ex)
            {
                throw new ApplicationException(ex.Message + " " + (ex.InnerException != null ? ex.InnerException.InnerException.Message : ""));
            }
        }
    }
}
